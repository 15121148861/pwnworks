require 'uri'
require 'net/http'
require 'base64'

def get_payload()
   data = File.binread(ARGV[0] || "testxml.xml")
   return Base64.strict_encode64(data)
end

if __FILE__ == $0
   uri = ::URI.parse("http://127.0.0.1:8000/products")
   http = Net::HTTP.new(uri.host,uri.port)
   request = Net::HTTP::Post.new(uri.path)
   request["Authorization"] = get_payload()
   request.body = File.binread("product.xml")
   
   res = http.request(request)
   puts res.body
end
